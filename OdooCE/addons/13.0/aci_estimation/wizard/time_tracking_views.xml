<?xml version="1.0" encoding="UTF-8"?>
<odoo>


    <!-- Block by kanban (js) -->

    <record id="aci_block_workcenter_from_view" model="ir.ui.view">
        <field name="name">aci.block.workcenter.from.view</field>
        <field name="model">tracking.management</field>
        <field name="arch" type="xml">
            <form string="Block Workcenter">
                <group>
                    <group col="4">
                        <group colspan="3">
                            <field name="loss_id" class="oe_inline" domain="[('manual','=',True)]"/>
                        </group>
                        <group colspan="1"></group>
                    </group>
                    <field name="description" placeholder="Add a description..."/>
                </group>
                <footer>
                    <button name="button_block" string="Block" type="object" class="btn-danger"/>
                    <button string="Cancel" class="btn-default" special="cancel" />
                </footer>
            </form>
        </field>
    </record>

    <record id="aci_block_workcenter_form_action" model="ir.actions.act_window">
        <field name="name">Block Workcenter</field>
        <field name="res_model">tracking.management</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="aci_block_workcenter_from_view"/>
        <field name="target">new</field>
    </record>

<!--     Wizard to register QTY-->
    <record id="time_tracking_actions_wizard_form_view" model="ir.ui.view">
        <field name="name">time.tracking.actions.wizard.form.view</field>
        <field name="model">time.tracking.actions.wizard</field>
        <field name="arch" type="xml">
            <form>
                <field name="is_block" invisible="1"/>
                <field name="key" invisible="1"/>
                <field name="change_project" invisible="1"/>
                <div style="padding-right:25px;
                            padding-top:2px;
                            padding-bottom:4px;
                            position: absolute;
                            top: 0;
                            right: 0;
                            text-align:right;">
                    <label for="time_block" class="counter_style" />
                    <field name="time_block" widget="accum_counter" class="counter"/><br></br>
                    <label for="time_remaining" class="counter_style"/>
                    <field name="time_remaining" widget="accum_times" class="counter" readonly="1"/><br></br>
                    <label for="qty_operators"/>
                    <field name="qty_operators"/>
                </div>
                <div>
                    <field name="record_type" invisible="1"/>
                    <p invisible="context.get('previous_activity') == False">
                        <strong>Register previous activities before continue</strong><br/>
                    </p>
                    <p invisible="context.get('previous_activity') == True">
                        <strong>Current Activity</strong><br/>
                    </p>
                </div>
                <div>
                    <div col="12">
                        <span><strong>Deadline:</strong></span>
                        <field name="block_end_date"/>
                        <button name="button_block" help="Show Block" icon="fa-clock-o" type="object" class="btn-secondary"/>
                    </div>
                </div>
                <group col="8">
                     <div attrs="{'invisible': [('is_block','==', False)]}">
                        <label for="time_record" class="counter_style"/>
                        <field name="time_record" widget="accum_counter_by_step" class="counter" readonly="1"/>
                     </div>
                 </group>
                <group>
                    <field name="activity_ids" nolabel="1"
                           context="{
                                   'tree_view_ref': 'aci_estimation.time_tracking_actions_activity_tree_view',
                                   'form_view_ref': 'aci_estimation.time_tracking_actions_activity_form_view'}"/>
                </group>
                <footer>
                    <button name="finish_btn" string="Finish" type="object" class="btn-primary"/>
                     <button name="new_project" string="Continue with new project" type="object" class="btn-primary"
                    attrs="{'invisible': [('change_project', '=', False)]}" invisible="(context.get('previous_activity') == True)"/>
                    <button string="Cancel" special="cancel" class="btn-default"/>
                </footer>
            </form>
        </field>
    </record>

    <record id="time_tracking_actions_activity_tree_view" model="ir.ui.view">
        <field name="name">time.tracking.actions.activity.tree.view</field>
        <field name="model">time.tracking.actions.activity</field>
        <field name="arch" type="xml">
            <tree create="0" delete="0" editable="top">
                <field name="infinite_qty" invisible="1"/>
                <field name="add_value" invisible="1"/>
                <field name="tracking_id" invisible="1"/>
                <field name="product_id" readonly="1" style="width: 40%"/>
                <field name="analytic_id" readonly="1"/>
                <field name="qty_accumulated" style="width: 60px; color: #73b754;" readonly="1"/>
                <field name="record_type" readonly="1"/>
                <field name="qty_product" readonly="1"
                       attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))],
                                'column_invisible': [('parent.record_type', '=', 'progress')]}"/>
                <field name="qty_expected" readonly="1"
                       attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))],
                       'column_invisible': [('parent.record_type', '=', 'progress')]}"/>
                <field name="qty_reference" style="width: 60px;color: #73b754;"
                        attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))],
                       'column_invisible': [('parent.record_type', '=', 'progress')]}" readonly="1"/>
               <field name="progress" string="Progress"
                      attrs="{'invisible': [('record_type', 'not in', ('progress_qty', 'progress_unit'))],
                       'column_invisible': [('parent.record_type', '=', 'number')]}"
                      nolabel="1" class="o_progress" style="width: 70px;"/>
                <field name="qty_progress"
                       attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))],
                               'readonly': [('record_type', '=', 'unit')],
                               'column_invisible': [('parent.record_type', '=', 'progress')]}"
                       nolabel="1" style="width: 60px;color: #ff6600;"/>
            </tree>
        </field>
    </record>
      <record id="time_tracking_actions_activity_form_view" model="ir.ui.view">
        <field name="name">time.tracking.actions.activity.form.view</field>
        <field name="model">time.tracking.actions.activity</field>
        <field name="arch" type="xml">
            <form string="Register QTY">
                <field name="infinite_qty" invisible="1"/>
                <field name="add_value" invisible="1"/>
                <field name="tracking_id" invisible="1"/>
                <group colspan="4" col="2">
                    <field name="product_id" readonly="1"/>
                    <field name="analytic_id" readonly="1"/>
                    <field name="record_type" readonly="1"/>
                    <field name="qty_accumulated" style="width: 60px; color: #73b754;" readonly="1"/>
                    <field name="qty_reference" style="width: 60px;color: #73b754;" readonly="1"/>
                </group>
                <group colspan="4" col="2">
                     <field name="qty_product" readonly="1" attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                     <field name="qty_expected" readonly="1" attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                     <field name="qty_reference" readonly="1"/>
                     <field name="progress" string="Progress"
                          attrs="{'invisible': [('record_type', 'not in', ('progress_qty', 'progress_unit'))]}"/>
                      <field name="qty_progress"
                           attrs="{'invisible': [('record_type', 'in', ('progress_qty', 'progress_unit'))],
                                   'readonly': [('record_type', '=', 'unit')]}"/>
                </group>
            </form>
        </field>
      </record>
<!--    View for single Tracking-->

    <record id="time_tracking_actions_single_wizard_form_view" model="ir.ui.view">
        <field name="name">time.tracking.actions.single.wizard.form.view</field>
        <field name="model">time.tracking.actions.wizard</field>
        <field name="arch" type="xml">
            <form>
                <field name="is_block" invisible="1"/>
                <field name="key" invisible="1"/>
                <field name="change_project" invisible="1"/>
                <div>
                    <field name="record_type" invisible="1"/>
                    <p invisible="context.get('previous_activity') == False">
                        <strong>Register previous activities before continue</strong><br/>
                    </p>
                    <p invisible="context.get('previous_activity') == True">
                        <strong>Current Activity</strong><br/>
                    </p>
                </div>
                <field name="product_id" nolabel="1" readonly="1"/><br></br>
                <field name="analytic_id" nolabel="1" readonly="1"/>
                <div>
                <div  class="o_row">
                    <field name="input_type" widget="radio" options="{'horizontal': true}"/>
                </div>
                <group>
                    <field name="infinite_qty" invisible="1"/>
                    <field name="add_value" invisible="1"/>
                    <field name="tracking_id" invisible="1"/>
                    <field name="qty_accumulated" invisible="1"/>
                    <field name="product_type" invisible="1"/>
                    <field name="qty_product" readonly="1"
                           attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    <field name="qty_expected" readonly="1"
                           attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    <field name="qty_reference" style="width: 60px;color: #73b754;"
                            attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"
                           readonly="1"/>

                    <label for="worked_duration"  attrs="{'invisible': [('qty_operators', '=', 1)]}"/>
                    <div class="o_row"  attrs="{'invisible': [('qty_operators', '=', 1)]}">
                        <field name="worked_duration" colspan="4"/>
                        <button type="object" name="show_worked_duration_calculator_btn"
                                icon="fa-calculator" help="Calculator" class="calculator_open"/>
                    </div>
                    <label for="qty_operators"/>
                    <div class="o_row">
                        <field name="qty_operators" colspan="4"/>
                        <button type="object" name="show_qty_operators_calculator_btn"
                                icon="fa-calculator" help="Calculator" class="calculator_open"/>
                    </div>
                    <field name="set_operators" invisible="1"/>
                    <field name="employee_ids" nolabel="1"
                         attrs="{'invisible': ['|', ('set_operators', '=', False),
                            ('qty_operators', '&lt;=', 1)]}">
                        <tree>
                            <field name="department_id" invisible="1"/>
                            <field name="employee_id" domain="[('department_id', '=', department_id)]"/>
                        </tree>
                    </field>
                    <label for="qty_product" attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    <div class="o_row">
                        <field name="qty_product" readonly="1" attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                        <field name="product_uom_id" nolabel="1" readonly="1" attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    </div>
                    <label for="qty_expected" attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    <div class="o_row">
                        <field name="qty_expected" readonly="1" attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                        <field name="product_uom_id" nolabel="1" readonly="1"
                        attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    </div>
                </group>
                </div>
                <group attrs="{'invisible': ['|', ('tracking_origin', '=', 'step'), ('input_type', '=', 'total')]}">
                    <field name="workorder_id" invisible="1"/>
                    <field name="tracking_origin" invisible="1"/>
                    <div class="o_row">
                        <label for="wo_step_ids"/>
                        <field name="wo_step_ids" readonly="1" nolabel="1" widget="many2many_tags"
                               attrs="{'invisible': [('tracking_origin', '=', 'step')]}"/>
                        <button type="object" name="show_progress_step_btn"
                                icon="fa-list" help="Steps"
                                attrs="{'invisible': [('product_type', 'not in', ('progress_qty', 'progress_unit'))]}"/>
                        <button type="object" name="show_qty_progress_step_btn"
                                icon="fa-list" help="Steps"
                                attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    </div>
                    <field name="step_count" invisible="1"/>
                </group>
                <group>
                    <label for="progress" attrs="{'invisible': [('product_type', 'not in', ('progress_qty', 'progress_unit'))]}"/>
                    <div class="o_row">
                        <field name="progress"  attrs="{'invisible': [('product_type', 'not in', ('progress_qty', 'progress_unit'))]}"/>
                        <p attrs="{'invisible': [('product_type', 'not in', ('progress_qty', 'progress_unit'))]}">%</p>
                         <button type="object" name="show_progress_calculator_btn"
                                    icon="fa-calculator" help="Calculator" class="calculator_open"
                                    attrs="{'invisible': ['|', ('input_type', '=', 'total'),
                                          ('product_type', 'not in', ('progress_qty', 'progress_unit'))]}"/>
                        <p attrs="{'invisible': ['|', ('tracking_origin', '=', 'step'),
                                                ('product_type', 'not in', ('progress_qty', 'progress_unit'))]}">Wo</p>
                        <p attrs="{'invisible': [('product_type', 'not in', ('progress_qty', 'progress_unit'))]}">Accum:</p>
                        <field name="accum_progress"  attrs="{'invisible': [('product_type', 'not in', ('progress_qty', 'progress_unit'))]}"/>
                    </div>
                    <label for="qty_progress" attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    <div class="o_row">
                        <field name="qty_progress" readonly="0"
                               attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                        <field name="product_uom_id" nolabel="1" readonly="1"
                               attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                        <button type="object" name="show_qty_progress_calculator_btn"
                                icon="fa-calculator" help="Calculator" class="calculator_open"
                                attrs="{'invisible': ['|', ('input_type', '=', 'total'),
                                       ('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                        <p attrs="{'invisible': ['|', ('tracking_origin', '=', 'step'),
                                                 ('product_type', 'in', ('progress_qty', 'progress_unit'))]}">Wo</p>
                        <p attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}">Accum:</p>
                         <field name="accum_qty"  attrs="{'invisible': [('product_type', 'in', ('progress_qty', 'progress_unit'))]}"/>
                    </div>
                    <div class="o_row" attrs="{'invisible': ['|', ('input_type', '=', 'total'),
                                                             ('step_count', '!=', 0)]}">
                        <button type="object" name="calculate_25" string = "25%"/>
                        <button type="object" name="calculate_50" string = "50%"/>
                        <button type="object" name="calculate_75" string = "75%"/>
                    </div>
                    <div class="o_row" attrs="{'invisible': ['|', ('input_type', '=', 'total'), ('tracking_origin', '=', 'workorder')]}">
                        <button type="object" name="calculate_25" string = "25%"/>
                        <button type="object" name="calculate_50" string = "50%"/>
                        <button type="object" name="calculate_75" string = "75%"/>
                    </div>
                </group>
                <group col="1">
                    <label for="note"/>
                    <field name="note" nolabel="1"/>
                </group>
                <field name="input_result" invisible="1"/>
                <footer>
                    <div class="alert alert-warning" role="alert" groups="aci_estimation.group_estimation_chief"
                    attrs="{'invisible': [('input_result', '=', 'normal')]}">
                      This will exceed the required qty
                    </div>
                    <button name="finish_btn" string="As Pending" type="object" class="btn-primary"/>
                    <button name="finish_approval_btn" string="Ask Approval" type="object" class="btn-primary"/>
                    <button type="object" name="finish_blocked_btn" string="As Blocked" class="btn btn-primary"/>
                    <button type="object" name="finish_forecast_btn" string="As Prestim" class="btn btn-primary"/>
                    <button string="Cancel" special="cancel" class="btn-default"/>
                </footer>
            </form>
        </field>
    </record>
</odoo>
