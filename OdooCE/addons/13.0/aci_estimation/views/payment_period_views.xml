<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="payment_group_tree_view" model="ir.ui.view">
        <field name="name">payment.period.group.tree.view</field>
        <field name="model">payment.period.group</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="initial_year"/>
                <field name="nomenclature"/>
            </tree>
        </field>
    </record>

    <record id="payment_group_form_view" model="ir.ui.view">
        <field name="name">payment.period.group.form.view</field>
        <field name="model">payment.period.group</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <header>
                        <button string="Compute Periods" name="open_plan_year" icon="fa-calendar"
                            type="object" help="Compute payment periods from pattern and year"
                            class="oe_read_only"/>
                        <button string="Update Nomenclature" name="update_nomenclature_button" icon="fa-refresh"
                            type="object" help="Update nomenclature for periods"
                            class="oe_read_only" />
                        <button string="Delete Periods" name="delete_periods_button"
                            type="object" help="Delete Periods"
                            class="oe_read_only"/>
                    </header>
                    <group>
                        <div class="oe_title">
                            <label class="oe_edit_only" for="name"/>
                            <h1><field name="name"/></h1>
                        </div>
                    </group>
                    <group>
                        <field name="has_periods" invisible="1"/>
                        <field name="initial_year" attrs="{'readonly': [('has_periods', '=', True)]}"/>
                        <field name="nomenclature"/>
                        <field name="tracking_window"/>
                        <field name="calendar_week"/>
                        <field name="format_language" attrs="{'invisible': [('calendar_week', '=', False)],
                                                             'required': [('calendar_week', '=', True)]}"
                               options="{'no_create': True, 'no_edit': True, 'no_open': True}"/>
                        <field name="week_start"   attrs="{'invisible': ['|', ('calendar_week', '=', False),
                                                                         ('format_language', '=', False)]}"/>
                        <field name="type_condition" attrs="{'invisible': [('calendar_week', '=', True)],
                                                             'readonly': [('has_periods', '=', True)]}"/>
                    </group>
                    <notebook attrs="{'invisible': [('calendar_week', '=', True)]}">
                        <page name="day_payment_conditions" string="Conditions"
                         attrs="{'invisible': [('type_condition', '=', 'number')]}">
                            <group>
                                <field name="day_condition_ids" nolabel="1"  attrs="{'readonly': [('has_periods', '=', True)]}">
                                    <tree editable="bottom">
                                        <control>
                                            <create name="add_condition_control" string="Add a condition"/>
                                            <create name="add_section_control" string="Add a week" context="{'default_display_type': 'line_section'}"/>
                                        </control>
                                        <field name="display_type" invisible="1"/>
                                        <field name="sequence" widget="handle"/>
                                        <field name="day"
                                        attrs="{'invisible': [('display_type', '=', 'line_section')]}"/>
                                        <field name="week"
                                        attrs="{'invisible': [('display_type', '=', False)]}"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page name="number_payment_conditions" string="Conditions"
                         attrs="{'invisible': [('type_condition', '=', 'day')]}">
                            <group>
                                <field name="number_condition_ids" nolabel="1"  attrs="{'readonly': [('has_periods', '=', True)]}">
                                    <tree editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="number"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page name="payment_period" string="Periods">
                            <group>
                                <field name="period_ids" nolabel="1">
                                    <tree create="0" delete="0" edit="0">
                                        <field name="global_sequence"/>
                                        <field name="sequence"/>
                                        <field name="name"/>
                                        <field name="year"/>
                                        <field name="from_date"/>
                                        <field name="to_date"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="payment_group_plan_year_form_view" model="ir.ui.view">
        <field name="name">payment.period.group.plan.year.form.view</field>
        <field name="model">payment.period.group</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="plan_year"/>
                    </group>
                    <footer>
                        <button name="compute_periods_button" string="Compute" class="oe_highlight" type="object"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </sheet>
            </form>
        </field>
    </record>

    <record id="period_type_action" model="ir.actions.act_window">
        <field name="name">Period Groups</field>
        <field name="res_model">payment.period.group</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('payment_group_tree_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('payment_group_form_view')})]"/>
    </record>
    <menuitem id="period_type_menu"
        name="Period Groups"
        parent="hr.menu_human_resources_configuration"
        action="period_type_action"
        sequence="5"
        groups="hr.group_hr_manager"/>
    <menuitem id="period_type_manu_menu"
        name="Period Groups"
        parent="mrp.menu_mrp_configuration"
        action="period_type_action"
        sequence="15"
        groups="aci_estimation.group_estimation_manager"/>

    <!-- PAYMENT PERIOD GROUP -->

<!--    &lt;!&ndash; Payment Period Group Tree View &ndash;&gt;-->
<!--    <record id="payment_period_group_tree_view" model="ir.ui.view">-->
<!--        <field name="name">payment.period.group.tree.view</field>-->
<!--        <field name="model">period.group</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <tree>-->
<!--                <field name="name"/>-->
<!--                <field name="year"/>-->
<!--            </tree>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Payment Period Group Form View &ndash;&gt;-->
<!--    <record id="payment_period_group_form_view" model="ir.ui.view">-->
<!--        <field name="name">payment.period.group.form.view</field>-->
<!--        <field name="model">payment.period.group</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <form>-->
<!--                <field name="state" invisible="1"/>-->
<!--                <header>-->
<!--                    <button string="Compute Periods" name="compute_periods_button" icon="fa-calendar"-->
<!--                        type="object" help="Compute payment periods from pattern and year"-->
<!--                        attrs="{'invisible': [('state', '=', 'draft')]}"-->
<!--                        class="oe_read_only"/>-->
<!--                    <button string="Update Nomenclature" name="update_nomenclatrue_button" icon="fa-refresh"-->
<!--                        type="object" help="Update nomenclature for periods"-->
<!--                        attrs="{'invisible': [('state', '=', 'draft')]}"-->
<!--                        class="oe_read_only"/>-->
<!--                </header>-->
<!--                <sheet>-->
<!--                    <group>-->
<!--                        <div class="oe_title">-->
<!--                            <label class="oe_edit_only" for="name"/>-->
<!--                            <h1><field name="name"/></h1>-->
<!--                        </div>-->
<!--                    </group>-->
<!--                    <group>-->
<!--                        <field name="start_date" invisible="1"/>-->
<!--                        <field name="dummy_year_name" invisible="1"/>-->
<!--                        <field name="dummy_type_name" invisible="1"/>-->
<!--                        <field name="dummy_close_name" invisible="1"/>-->
<!--                        <group>-->
<!--                            <field name="year"/>-->
<!--                            <field name="nomenclature"/>-->
<!--                            <field name="first_close" required="1"/>-->
<!--                        </group>-->
<!--                        <group>-->
<!--                            <field name="period_type"/>-->
<!--                            <field name="close_day"/>-->
<!--                            &lt;!&ndash;-->
<!--                            <label for="day_from" string="Pattern"/>-->
<!--                            <div>-->
<!--                                <field name="day_from" class="oe_inline"/>-->
<!--                                <span style="margin-left: 10px; margin-right: 10px;"><b>to</b></span>-->
<!--                                <field name="day_to" class="oe_inline"/>-->
<!--                            </div>-->
<!--                            &ndash;&gt;-->
<!--                        </group>-->
<!--                    </group>-->
<!--                    <notebook>-->
<!--                        <page name="payment_periods" string="Payment Periods">-->
<!--                            <group>-->
<!--                                <field name="payment_period_ids" nolabel="1" options="{'reload_on_button': True}">-->
<!--                                    <tree create="0" delete="0" editable="top">-->
<!--                                        <field name="sequence" invisible="1"/>-->
<!--                                        <field name="name"/>-->
<!--                                        <field name="from_date"/>-->
<!--                                        <field name="to_date"/>-->
<!--                                    </tree>-->
<!--                                </field>-->
<!--                            </group>-->
<!--                        </page>-->
<!--                    </notebook>-->
<!--                </sheet>-->
<!--            </form>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Payment Period Group Action View &ndash;&gt;-->
<!--    <record id="period_group_action" model="ir.actions.act_window">-->
<!--        <field name="name">Payment Groups</field>-->
<!--        <field name="res_model">payment.period.group</field>-->
<!--        <field name="view_mode">tree,form</field>-->
<!--        <field name="view_id" ref="payment_period_group_tree_view"/>-->
<!--        <field name="target">current</field>-->
<!--    </record>-->

<!--    <record id="period_group_action" model="ir.actions.act_window">-->
<!--        <field name="name">Payment Groups</field>-->
<!--        <field name="res_model">payment.period.group</field>-->
<!--        <field name="view_mode">tree,form</field>-->
<!--        <field name="view_id" ref="payment_period_group_tree_view"/>-->
<!--        <field name="target">current</field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Payment Period &ndash;&gt;-->
<!--    <record id="payment_period_tree_view" model="ir.ui.view">-->
<!--        <field name="name">payment.period.tree.view</field>-->
<!--        <field name="model">payment.period</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <tree>-->
<!--                <field name="sequence"/>-->
<!--                <field name="group_id"/>-->
<!--                <field name="period_type"/>-->
<!--                <field name="name"/>-->
<!--                <field name="from_date"/>-->
<!--                <field name="to_date"/>-->
<!--                <field name="year"/>-->
<!--            </tree>-->
<!--        </field>-->
<!--    </record>-->
<!--    <record id="payment_period_search_view" model="ir.ui.view">-->
<!--        <field name="name">payment.period.search</field>-->
<!--        <field name="model">payment.period</field>-->
<!--        <field name="mode">primary</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <search>-->
<!--                <field name="group_id"/>-->
<!--                <field name="year"/>-->
<!--                <field name="from_date"/>-->
<!--                <field name="to_date"/>-->
<!--                <separator />-->
<!--                <filter name="fortnightly" string="Fortnightly" domain="[('period_type','=','biweekly')]"/>-->
<!--                <filter name="weekly" string="Weekly" domain="[('period_type','=','weekly')]"/>-->
<!--                <separator />-->
<!--                <filter name="current_period" string="Current Period"-->
<!--                    domain="[-->
<!--                        '&amp;',-->
<!--                        ('to_date', '&gt;=', (context_today()-relativedelta(days=14)).strftime('%Y-%m-%d')),-->
<!--                        ('to_date', '&lt;=', context_today().strftime('%Y-%m-%d')),-->
<!--                    ]"/>-->
<!--                <filter name="previous_period" string="Previous Period"-->
<!--                    domain="[-->
<!--                        '&amp;',-->
<!--                        ('to_date', '&gt;=', (context_today()-relativedelta(days=28)).strftime('%Y-%m-%d')),-->
<!--                        ('to_date', '&lt;=', (context_today()-relativedelta(days=14)).strftime('%Y-%m-%d')),-->
<!--                    ]"/>-->
<!--            </search>-->
<!--        </field>-->
<!--    </record>-->

<!--    <record id="payment_period_action" model="ir.actions.act_window">-->
<!--        <field name="name">Payment Periods</field>-->
<!--        <field name="res_model">payment.period</field>-->
<!--        <field name="search_view_id" ref="payment_period_search_view"/>-->
<!--        <field name="context">{'search_default_current_period':1}</field>-->
<!--        <field name="view_mode">tree</field>-->
<!--        <field name="target">current</field>-->
<!--    </record>-->


<!--    &lt;!&ndash; MENUS &ndash;&gt;-->
<!--    <menuitem id="period_group_menu"-->
<!--        name="Payment Groups"-->
<!--        parent="hr.menu_human_resources_configuration"-->
<!--        action="period_group_action"-->
<!--        sequence="5"-->
<!--        groups="hr.group_hr_manager"/>-->

<!--    <menuitem id="payroll_period_menu"-->
<!--        name="Payment Periods"-->
<!--        parent="hr.menu_human_resources_configuration"-->
<!--        action="payment_period_action"-->
<!--        sequence="6"-->
<!--        groups="hr.group_hr_manager"/>-->

    <!-- hr_attendance menus -->
    <!-- Inherit menu for unlink action -->
<!--    <menuitem id="hr_attendance.menu_hr_attendance_settings"-->
<!--        name="Configuration"-->
<!--        parent="hr_attendance.menu_hr_attendance_root"-->
<!--        sequence="99"-->
<!--        groups="hr_attendance.group_hr_attendance_manager"/>-->

<!--    &lt;!&ndash; Substitute action menu: hr attendance settings &ndash;&gt;-->
<!--    <menuitem id="aci_estimation.menu_hr_attendance_settings"-->
<!--        name="Settings"-->
<!--        parent="hr_attendance.menu_hr_attendance_settings"-->
<!--        sequence="5"-->
<!--        action="hr_attendance.action_hr_attendance_settings"-->
<!--        groups="hr_attendance.group_hr_attendance_manager"/>-->

<!--    <menuitem id="attendance_period_group_menu"-->
<!--        name="Payment Periods"-->
<!--        parent="hr_attendance.menu_hr_attendance_settings"-->
<!--        action="period_group_action"-->
<!--        sequence="10"-->
<!--        groups="hr_attendance.group_hr_attendance_manager"/>-->


</odoo>
